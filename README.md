#  4NN team üß®

–ü—Ä–∏–≤—ñ—Ç!
–ú–∏ –∫–æ–º–∞–Ω–¥–∞ 4NN —ñ –º–∏ –≥–æ—Ç–æ–≤—ñ –ø—Ä–µ–∑–µ–Ω—Ç—É–≤–∞—Ç–∏ –Ω–∞—à–µ —Ä—ñ—à–µ–Ω–Ω—è :)
–ü–æ–≤–Ω–∏–π –ø—Ä–æ–≥—Ä–∞–º–Ω–∏–π –∫–æ–¥ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ —à–ª—è—Ö–æ–º Model.ipynb

## Data sources

- Kaggle input data (https://www.kaggle.com/competitions/int20h-2023-hackathon/data)
- OpenStreetMap (https://www.openstreetmap.org/)
- Weather (https://www.wunderground.com/)

## Preprocess

–û–∫—Ä—ñ–º –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Å–æ—Ä—Å–∞–º–∏ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ feature engineering –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è 5 –Ω–æ–≤–∏—Ö —Ñ—ñ—á

- seconds - time of a day
- distance ‚Äì sum of the lengths of the nodes
- mean_speed - average time of speed in the city for every 30 minutes in a day (peak hour // traffic jams)
- mean_time - the average travel time on each interval
- speed - average speed across all nodes for a specific order

## Model

- –í —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ TabNet —Ç–∞ XGBoost: {'max_depth': 3, 'min_child_weight': 4, 'gamma': 0.15, 'colsample_bytree': 0.85, 'subsample': 1.0}
- –í —è–∫–æ—Å—Ç—ñ –º–µ—Ç—Ä–∏–∫–∏ RMSE.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ cross-val.
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Optuna.

–ü—Ä–∏ –Ω–∞–≤—á–∞–Ω–Ω—ñ –º–æ–¥–µ–ª—ñ –º–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –º–µ—Ç—Ä–∏–∫—É RMSE, —â–æ –¥–æ—Ä—ñ–≤–Ω—é—î 120.49735

## Results

–¢–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ SHAP –¥–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ feature importance —Ä–∞–∑–æ–º –∑—ñ –∑–Ω–∞–∫–æ–º –∑–º—ñ–Ω–Ω–∏—Ö, —â–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –≤ —è–∫—É —Å—Ç–æ—Ä–æ–Ω—É –≤–æ–Ω–∏ –º–∞—é—Ç—å –≤–ø–ª–∏–≤:
(–∑–≤—ñ—Å–Ω–æ —ñ —Å—é–¥–∏ –±–µ—Ä–µ–º cross-val, –∞–¥–∂–µ feature-importance –∑–º—ñ–Ω—é—î—Ç—å—Å—è –≤—ñ–¥ –º–æ–¥–µ–ª—ñ –¥–æ –º–æ–¥–µ–ª—ñ)
![App Screenshot](result.jpg)

SHAP –ø–æ–∫–∞–∑—É—î –≤–ø–ª–∏–≤ (–∑–Ω–∞–∫) –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª—ñ —Ç–∞ feature importance –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä—É —ñ —Å–æ—Ä—Ç—É—î —ó—Ö –≤—ñ–¥ –Ω–∞–π–≤–ø–ª–∏–≤–æ–≤—ñ—à–æ–≥–æ –¥–æ –Ω–∞–π–º–µ–Ω—å—à–æ–≥–æ: 
- –Ω–∞–π–±—ñ–ª—å—à –≤–ø–ª–∏–≤–æ–≤–∏–π —Ñ–∞–∫—Ç–æ—Ä mean_time, —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –ø—Ä–æ—ó–∑–¥—É –Ω–∞ –∫–æ–∂–Ω–æ–º—É –ø—Ä–æ–º—ñ–∂–∫—É.
- –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä distance - —Å—É–º–∞ –¥–æ–≤–∂–∏–Ω–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º –ø–æ –Ω–æ–¥–∞–º.
- –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä seconds, —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä —î –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —á–∞—Å –¥–æ–±–∏.
- –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä mean_speed - –ø–∞—Ä–∞–º–µ—Ç—Ä —â–æ –ø–æ–∫–∞–∑—É—î —Å–µ—Ä–µ–¥–Ω—é —à–≤–∏–¥–∫—ñ—Å—Ç—å –ø–æ –º—ñ—Å—Ç—É –∑ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –≤ 30—Ö–≤. –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞—Ç–æ—Ä–∏ —Ç–∞ —á–∞—Å –ø—ñ–∫.
- highway_traffic_signals - –ø–∞—Ä–∞–º–µ—Ç—Ä —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å traffic_signals –Ω–∞ –º–∞—Ä—à—Ä—É—Ç—ñ.
- route_distance_km - –¥–æ–≤–∂–∏–Ω–∞ –º–∞—Ä—à—Ä—É—Ç—É –≤ –∫—ñ–ª–æ–º–µ—Ç—Ä–∞—Ö.
- trolleybus_yes - –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —á–∏ —ó–∑–¥—è—Ç—å —Ç—Ä–æ–ª–µ–π–±—É—Å–∏ –ø–æ –¥–∞–Ω–æ–º—É –º–∞—Ä—à—Ä—É—Ç—É.
- speed - —Å–µ—Ä–µ–¥–Ω—è —à–≤–∏–¥–∫—ñ—Å—Ç—å –ø–æ –≤—Å—ñ—Ö –Ω–æ–¥–∞—Ö –¥–ª—è –ø–µ–≤–Ω–æ–≥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.
- crossing_marked - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ—à–æ—Ö—ñ–¥–Ω–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç—ñ–≤.
- humidity - –≤–æ–ª–æ–≥—ñ—Å—Ç—å –ø–æ–≤—ñ—Ç—Ä—è.
- crossing_traffic_signals - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–≤—ñ—Ç–æ—Ñ–æ—Ä—ñ–≤.
- bus_yes - –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —á–∏ —ó–∑–¥—è—Ç—å –∞–≤—Ç–æ–±—É—Å–∏ –ø–æ –¥–∞–Ω–æ–º—É –º–∞—Ä—à—Ä—É—Ç—É.
- railway_tram_level_crossing - —á–∏ —î –ø–µ—Ä–µ—Ç–∏–Ω –∑ —Ç—Ä–∞–º–≤–∞–π–Ω–∏–º–∏ —Ä–µ–π–∫–∞–º–∏.
- wind speed - —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ—Ç—Ä—É.
- highway_crossing - —Ü–µ–π —Ç–µ–≥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º—ñ—Å—Ü—è –ø–µ—Ä–µ—Ö–æ–¥—É –≤—É–ª–∏—Ü—ñ –¥–ª—è –ø—ñ—à–æ—Ö–æ–¥—ñ–≤ —Ç–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∏—Å—Ç—ñ–≤.
- traffic_signals_signal- —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —Å–≤—ñ—Ç–æ—Ñ–æ—Ä–∏.
- crossing_uncontrolled - –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω—ñ –ø—ñ—à–æ—Ö—ñ–¥–Ω—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏.
- traffic_signals_direction_both - —Ä—É—Ö –ø–æ –¥–æ—Ä–æ–∑—ñ —É 2 –Ω–∞–ø—Ä—è–º–∫–∞—Ö.
- public_transport_stop_position- –∑—É–ø–∏–Ω–∫–∏ –≥—Ä–æ–º–∞–¥—Å—å–∫–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É.
- direction_forward - —Ä—É—Ö –ø–æ –¥–æ—Ä–æ–∑—ñ —É –æ–¥–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É.


## Next Steps

- –ü–æ–¥—É–º–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ seq2seq –º–æ–¥–µ–ª—ñ –ø–æ–¥—ñ–π.